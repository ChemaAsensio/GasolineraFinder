<div class="home-container">
  <h2>GasolineraFinder</h2>

  <!-- Selector de modo -->
  <div class="mode-selection">
    <select [(ngModel)]="modoSeleccionado" (change)="onModoCambiado()">
      <option value="buscar">Buscar Gasolineras</option>
      <option value="ruta">Gasolineras en Ruta</option>
    </select>
  </div>

  <!-- DirecciÃ³n de Inicio -->
  <div class="direccion-container">
    <h3>Inicio</h3>
    
    <div class="campo-direccion">
      <label for="calleInicio">Calle:</label>
      <input id="calleInicio" [(ngModel)]="ubicacionUsuario.calle" placeholder="Nombre de la calle" />
    </div>
    
    <div class="campo-direccion">
      <label for="numeroInicio">NÃºmero:</label>
      <input id="numeroInicio" [(ngModel)]="ubicacionUsuario.numero" placeholder="NÃºmero" />
    </div>
    
    <div class="campo-direccion">
      <label for="ciudadInicio">Ciudad:</label>
      <input id="ciudadInicio" [(ngModel)]="ubicacionUsuario.ciudad" placeholder="Ciudad" />
    </div>
    
    <div class="campo-direccion">
      <label for="provinciaInicio">Provincia:</label>
      <input id="provinciaInicio" [(ngModel)]="ubicacionUsuario.provincia" placeholder="Provincia" />
    </div>
    
    <button (click)="obtenerUbicacion()" class="btn-obtener-ubicacion">
      ğŸ“ Obtener mi ubicaciÃ³n
    </button>
    
    <!-- BotÃ³n para analizar la zona -->
    <button (click)="analizarZona()" class="btn-analizar-zona" style="margin-top: 10px;">
      ğŸ“Š Analizar zona
    </button>
  </div>

  <div style="margin-top: 10px; display: flex; gap: 10px;">
  <button (click)="depurarFiltroAbiertas()" class="btn-analizar-zona">
    ğŸ” Depurar filtro "abiertas"
  </button>
  
  <button (click)="exportarDatosParaDepuracion()" class="btn-analizar-zona">
    ğŸ“Š Exportar datos depuraciÃ³n
  </button>
</div>

  <!-- DirecciÃ³n de Destino (solo en modo "ruta") -->
  <div *ngIf="modoSeleccionado === 'ruta'" class="direccion-container">
    <h3>Destino</h3>
    
    <div class="campo-direccion">
      <label for="calleDestino">Calle:</label>
      <input id="calleDestino" [(ngModel)]="destino.calle" placeholder="Nombre de la calle" />
    </div>
    
    <div class="campo-direccion">
      <label for="numeroDestino">NÃºmero:</label>
      <input id="numeroDestino" [(ngModel)]="destino.numero" placeholder="NÃºmero" />
    </div>
    
    <div class="campo-direccion">
      <label for="ciudadDestino">Ciudad:</label>
      <input id="ciudadDestino" [(ngModel)]="destino.ciudad" placeholder="Ciudad" />
    </div>
    
    <div class="campo-direccion">
      <label for="provinciaDestino">Provincia:</label>
      <input id="provinciaDestino" [(ngModel)]="destino.provincia" placeholder="Provincia" />
    </div>
  </div>

  <!-- Filtros -->
  <app-filters 
    [empresasDisponibles]="empresasDisponibles"
    [filters]="filters"
    (filterChange)="onFiltersCambiados($event)">
  </app-filters>

  <!-- Resumen de gasolineras -->
<app-summary-box 
  *ngIf="gasolinerasFiltradas.length > 0"
  [stations]="gasolinerasFiltradas"
  [filters]="filters">
</app-summary-box>
  <!-- Lista de gasolineras -->
  <div *ngIf="gasolinerasFiltradas.length > 0">
    <h3>Gasolineras encontradas ({{ gasolinerasFiltradas.length }})</h3>
    <app-station-list 
      [stations]="gasolinerasFiltradas"
      [filters]="filters">
    </app-station-list>
  </div>

  <!-- Mensajes de estado -->
  <div *ngIf="cargando" class="alert alert-info">
    <p>Cargando gasolineras...</p>
  </div>
  
  <div *ngIf="error" class="alert alert-error">
    <p>{{ error }}</p>
  </div>
  
  <div *ngIf="!cargando && !error && gasolinerasFiltradas.length === 0" class="alert alert-info">
    <p>No se encontraron gasolineras con los filtros aplicados.</p>
    <button (click)="restablecerFiltros()" class="btn-restablecer">
      Restablecer filtros
    </button>
  </div>

  <!-- Detalles de gasolinera seleccionada -->
  <div *ngIf="gasolineraSeleccionada" class="card mt-4">
    <div class="card-header">
      <h3>{{ gasolineraSeleccionada.rotulo }}</h3>
    </div>
    <div class="card-body">
      <p><strong>DirecciÃ³n:</strong> {{ gasolineraSeleccionada.direccion }}</p>
      <p><strong>Horario:</strong> {{ gasolineraSeleccionada.horario }}</p>
      <p><strong>Municipio:</strong> {{ gasolineraSeleccionada.municipio }}</p>
      <p><strong>Provincia:</strong> {{ gasolineraSeleccionada.provincia }}</p>
      <p><strong>Precios:</strong></p>
      <ul>
        <li *ngIf="gasolineraSeleccionada.precioGasolina95 > 0">
          Gasolina 95: {{ gasolineraSeleccionada.precioGasolina95 | number:'1.3-3' }} â‚¬/L
        </li>
        <li *ngIf="gasolineraSeleccionada.precioGasolina98 > 0">
          Gasolina 98: {{ gasolineraSeleccionada.precioGasolina98 | number:'1.3-3' }} â‚¬/L
        </li>
        <li *ngIf="gasolineraSeleccionada.precioDiesel > 0">
          DiÃ©sel: {{ gasolineraSeleccionada.precioDiesel | number:'1.3-3' }} â‚¬/L
        </li>
        <li *ngIf="gasolineraSeleccionada.precioDieselPremium > 0">
          DiÃ©sel Premium: {{ gasolineraSeleccionada.precioDieselPremium | number:'1.3-3' }} â‚¬/L
        </li>
        <li *ngIf="gasolineraSeleccionada.precioGLP > 0">
          GLP: {{ gasolineraSeleccionada.precioGLP | number:'1.3-3' }} â‚¬/L
        </li>
      </ul>
    </div>
  </div>
</div>
